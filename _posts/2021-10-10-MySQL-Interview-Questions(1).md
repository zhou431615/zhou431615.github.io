---
layout:     post
title:      "MySQL之面试题（一）"
subtitle:   "MySQL学习笔记"
date:       2021-09-10 08:00:00
author:     "qianye"

tags:
- MySQL
---

##  MySQL之面试题(一)
> MySQL高频面试题
### 1、MySQL 中有哪几种锁？

1. 表级锁：开销小，加锁快；不会出现死锁；锁定粒度大，发生锁冲突的概率最 高，并发度最低。
2. 行级锁：开销大，加锁慢；会出现死锁；锁定粒度最小，发生锁冲突的概率最 低，并发度也最高。 
3. 页面锁：开销和加锁时间界于表锁和行锁之间；会出现死锁；锁定粒度界于表 锁和行锁之间，并发度一般。

>  **锁的概念：**  什么是锁？
>
> **锁是事务对某个数据库中的资源（如表和记 录）存取前，先向系统提出请求，封锁该资源，**
>
> 事务获得锁后，即取得对数据的控制权，在事务释放它的锁之前，其他事务不能更新此数据。当事务撤消后，释放被 锁定的资源。
>
> ## **为什么要锁？**
>
>   数据库是一个多用户使用的共享资源,比如一个用户表 t_user,两个浏览器前面的人登录了同个一个账号，把电话号码改了。当多个用户并发地存取数据时，在数据库中就会产生多个事务同时存取同一数据的情况。若对并发操作不加控制就可能会读取和存储不正确的数据，破坏数据库的一致性(脏读，不可重复读，幻读等)，可能产生死锁。为了解决这个问题，加锁是一个非常重要的技术，对实现数据库并发控制是一个好的方案。简单说，当一个执行sql语句的事务想要操作表记录之前，先向数据库发出请求，对你访问的记录集加锁，在这个事务释放这个锁之前，其他事务不能对这些数据进行更新操作。

### 2、MySQL 中有哪些不同的表格？ 

共有 5 种类型的表格： 

1、MyISAM

 2、Heap 

3、Merge

 4、INNODB 

5、ISAM

### 3、简述在 MySQL 数据库中 MyISAM 和 InnoDB 的区别？

 MyISAM： 

-  不支持事务，但是每次查询都是原子的； 

- 支持表级锁，即每次操作是对整个表加锁； 
- 存储表的总行数； 
- 一个 MYISAM 表有三个文件：索引文件、表结构文件、数据文件；
-  采用菲聚集索引，索引文件的数据域存储指向数据文件的指针。辅索引与主索引 基本一致，但是辅索引不用保证唯一性。



 InnoDb：

-   支持 ACID 的事务，支持事务的四种隔离级别； 
- 支持行级锁及外键约束：因此可以支持写并发； 
- 不存储总行数；
-  一个 InnoDb 引擎存储在一个文件空间（共享表空间，表大小不受操作系统控制， 一个表可能分布在多个文件里），也有可能为多个（设置为独立表空，表大小受 操作系统文件大小限制，一般为 2G），受操作系统文件大小的限制；
-  主键索引采用聚集索引（索引的数据域存储数据文件本身），辅索引的数据域存 储主键的值；因此从辅索引查找数据，需要先通过辅索引找到主键值，再访问辅 索引；最好使用自增主键，防止插入数据时，为维持 B+树结构，文件的大调整。

### 4、MySQL 中 InnoDB 支持的四种事务隔离级别名称，以及逐 级之间的区别？

 SQL 标准定义的四个隔离级别为：

 1、read uncommited ：读到未提交数据 

 2、read committed：脏读，不可重复读

 3、repeatable read：可重读

 4、serializable ：串行事物

### 5、CHAR 和 VARCHAR 的区别？ 

1、CHAR 和 VARCHAR 类型在存储和检索方面有所不同

2、CHAR 列长度固定为创建表时声明的长度，长度值范围是 1 到 255 当 CHAR 值被存储时，它们被用空格填充到特定长度，检索 CHAR 值时需删除尾随空格。

### 6、主键和候选键有什么区别？

 表格的每一行都由主键唯一标识,一个表只有一个主键。

 主键也是候选键。按照惯例，候选键可以被指定为主键，并且可以用于任何外键 引用

### 7、myisamchk 是用来做什么的？

 它用来压缩 MyISAM 表，这减少了磁盘或内存使用。 

##### MyISAM Static 和 MyISAM Dynamic 有什么区别？

 在 MyISAM Static 上的所有字段有固定宽度。动态 MyISAM 表将具有像 TEXT， BLOB 等字段，以适应不同长度的数据类型。

 MyISAM Static 在受损情况下更容易恢复。

### 8、如果一个表有一列定义为 TIMESTAMP，将发生什么？ 

每当行被更改时，时间戳字段将获取当前时间戳。 

##### 列设置为 AUTO INCREMENT 时，如果在表中达到最大值，会发生什么情况？ 

它会停止递增，任何进一步的插入都将产生错误，因为密钥已被使用。

#####  怎样才能找出最后一次插入时分配了哪个自动增量？ 

LAST_INSERT_ID 将返回由 Auto_increment 分配的最后一个值，并且不需要指 定表名称。

### 9、你怎么看到为表格定义的所有索引？

 索引是通过以下方式为表格定义的： 

 SHOW INDEX FROM ; 

### 10、LIKE 声明中的％和_是什么意思？ 

_％对应于 0 个或更多字符，_只是 LIKE 语句中的一个字符。 

##### 如何在 Unix 和 MySQL 时间戳之间进行转换？

 UNIX_TIMESTAMP 是从 MySQL 时间戳转换为 Unix 时间戳的命令 

FROM_UNIXTIME 是从 Unix 时间戳转换为 MySQL 时间戳的命令

### 11、列对比运算符是什么？ 

在 SELECT 语句的列比较中使用=，<>，<=，<，> =，>，<<，>>，<=>，AND， OR 或 LIKE 运算符。

### 12、BLOB 和 TEXT 有什么区别？

 BLOB 是一个二进制对象，可以容纳可变数量的数据。

TEXT 是一个不区分大小写 的 BLOB。

 BLOB 和 TEXT 类型之间的唯一区别在于对 BLOB 值进行排序和比较时区分大小 写，对 TEXT 值不区分大小写。

### 13、MySQL_fetch_array 和 MySQL_fetch_object 的区别是什么？

 以下是 MySQL_fetch_array 和 MySQL_fetch_object 的区别：

 MySQL_fetch_array（） – 将结果行作为关联数组或来自数据库的常规数组返回。

 MySQL_fetch_object – 从数据库返回结果行作为对象。 

### 14、MyISAM 表格将在哪里存储，并且还提供其存储格式？ 

每个 MyISAM 表格以三种格式存储在磁盘上：

 “.frm”文件存储表定义

 数据文件具有“.MYD”（MYData）扩展名 

索引文件具有“.MYI”（MYIndex）扩展名 

### 15、MySQL 如何优化 DISTINCT？ 

DISTINCT 在所有列上转换为 GROUP BY，并与 ORDER BY 子句结合使用。

 SELECT DISTINCT t1.a FROM t1,t2 where t1.a=t2.a;
